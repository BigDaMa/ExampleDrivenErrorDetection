import numpy as np

from ml.datasets.flights.FlightHoloClean import FlightHoloClean
from ml.plot.old.user_effort_all_potential.PlotterLatex import PlotterLatex

data = FlightHoloClean()

label_potential = [4, 8, 12, 16, 26, 36, 46, 56, 66, 76, 86, 96, 106, 116, 126, 136, 146, 156, 166, 176, 186, 196, 206, 216, 226, 236, 246, 256, 266, 276, 286, 296, 306, 316, 326, 336, 346, 356, 366, 376, 386, 396, 406, 416, 426, 436, 446, 456, 466, 476, 486, 496, 506, 516, 526, 536, 546, 556, 566, 576, 586, 596, 606, 616, 626, 636, 646, 656]


fscore_metadata_no_svd_more_data = []
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.5378378378377495, 0.6711690731252585, 0.7988718148219255, 0.8129203179131159, 0.8337423312883027, 0.83239211507712, 0.8383902233459505, 0.8529319535903761, 0.890221589754002, 0.8906709978682222, 0.8945061665477523, 0.8948591051410035, 0.901264298615376, 0.8982083875488502, 0.8994899489949757, 0.8998699609883806, 0.9060154138724267, 0.9088738559489878, 0.9130651761652336, 0.9151246983105652, 0.9135901820742602, 0.9137636783455343, 0.913789662741991, 0.9118889559444288, 0.9119983908276728, 0.9149128990030851, 0.9197537094982675, 0.9251353283627073, 0.9278371501271944, 0.9275480134132082, 0.9263479145472345, 0.9306950786402215, 0.9272634271100354, 0.935219807983892, 0.943301049233281, 0.9444166249374054, 0.9535932645083677, 0.947889315289838, 0.9514974286578292, 0.9514974286578292, 0.9543259557343926, 0.9574297188754993, 0.9587257062712867, 0.9598796389167474, 0.9619897703339348, 0.9623984758848619, 0.9637637637637388, 0.9669139763384753, 0.9696786541754778, 0.9711402623612395, 0.9730275785432979, 0.9733225545675136, 0.9742241989285331, 0.9759352881698803, 0.9757330637007184, 0.9764622689160559, 0.9764622689160559, 0.9774724719668516, 0.9784739767559276, 0.9790676509252718, 0.97976937082743, 0.9813036887316771, 0.9832051800890237])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.5605545738751758, 0.6923259681634711, 0.8046163190929918, 0.8165358451072747, 0.8253497244595459, 0.8422884044623405, 0.8428805237317962, 0.8434591655340871, 0.8699979266018432, 0.8758303525805949, 0.8830524247751569, 0.8747252747252614, 0.8829753797799695, 0.8802916751063531, 0.8813116073225351, 0.8912648779503088, 0.8875811688312324, 0.8926647326979306, 0.9045575311669347, 0.9055294837787625, 0.9069222142929481, 0.920557420404818, 0.9174554707378729, 0.920301671422709, 0.9226372729129552, 0.9232966136271965, 0.9237512742100809, 0.9254582484725851, 0.9280832398246373, 0.9302515851913269, 0.9304757998359318, 0.9340715677227509, 0.9348204236160712, 0.9369941604343653, 0.940246406570844, 0.9442905509387406, 0.947486948510647, 0.9524586819016492, 0.9583249039045075, 0.9623878188968386, 0.9587764610554151, 0.965308592174258, 0.9668179525970606, 0.9707011517478106, 0.9711216941939217, 0.9718737353298293, 0.9760940032414785, 0.9779307552135856, 0.9788139888494557, 0.9776966747769881, 0.9800101471334458, 0.9798276735935071, 0.9805510534845898, 0.9805471124619929, 0.9807536466774606, 0.9824845600890921, 0.9828722002634973, 0.9837530463037949, 0.985065528802172, 0.9855925324675163, 0.9866017052375051, 0.9884240454914549, 0.9888347543645787])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.5592479809347545, 0.6901809079530551, 0.8144831613783421, 0.8134035423648034, 0.8218224027859362, 0.8179233258161398, 0.8126938184824175, 0.8315745040100282, 0.8321214037305313, 0.8485534850200146, 0.87968127490035, 0.885623510722714, 0.8834990059642805, 0.8903714029673455, 0.8946414182112509, 0.8974153476257879, 0.898968659257116, 0.8990788946736972, 0.9007419290155284, 0.9038345713712608, 0.9168251426284325, 0.9175372755856778, 0.9236540606306648, 0.9243869908689926, 0.9278245863364227, 0.9338227796472024, 0.9352708058124235, 0.9348158726920351, 0.9353713582273171, 0.9362704918032968, 0.9338385907414893, 0.9337417049514934, 0.9338505512453967, 0.9317671092952267, 0.9312697281336013, 0.9327790733043119, 0.9344445573737782, 0.939234352845896, 0.9419367868322958, 0.94445004536751, 0.9486253261088016, 0.9518447773198022, 0.9543493528644739, 0.9562600321027471, 0.956687387206791, 0.956687387206791, 0.9571142284569361, 0.9594716301410975, 0.9612340979665605, 0.9643429487179561, 0.9668074834037342, 0.9686179843089958, 0.9692942716198479, 0.9717104600825357, 0.971757111155951, 0.9729566703528698, 0.9706147828703255, 0.9766552626282988, 0.9779877374610502, 0.9786634460547551, 0.9786634460547551, 0.9787576764321215, 0.9787790405310425])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.5564591387815344, 0.6838845389739904, 0.8020524965464574, 0.8150881508815593, 0.795967042497729, 0.8102439562865328, 0.8244756004783161, 0.8359545880639838, 0.8365604830317345, 0.8438316097359011, 0.8396533044422977, 0.8627115013923466, 0.8765509989485221, 0.8738813735692292, 0.8750519750519624, 0.8812157551947893, 0.8828716671852572, 0.8828716671852572, 0.8861965413687634, 0.8992634090671385, 0.9036914827801208, 0.9024591857823702, 0.9052718286657574, 0.9066721666496843, 0.9063239074551869, 0.9073120494337827, 0.9083607907744993, 0.9086978898612544, 0.9174856674858554, 0.9174876847292889, 0.9207454433751948, 0.9173179761416985, 0.923108468320921, 0.9233292332925741, 0.9233292332925741, 0.923882896764245, 0.9261316872428682, 0.930751895103591, 0.9366312346688953, 0.937904136303009, 0.941572346283285, 0.9450213805742411, 0.9554140127388902, 0.9550755501470928, 0.9582698751142514, 0.9585197234648312, 0.959739068392638, 0.9591108391965296, 0.964041968014692, 0.9664964249234157, 0.968262067557952, 0.9680970339415149, 0.9708579580191659, 0.9731325055973912, 0.9751172751376882, 0.9764645950076437, 0.9790224032586591, 0.9780130293159733, 0.9809020723283306, 0.9815153361771312, 0.9822172543440837, 0.9838627829087625, 0.9849746192893404])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3016914049014996, 0.4908646237947587, 0.6478337978207945, 0.7850548495708033, 0.7540605920974285, 0.8104048759248877, 0.8384549722579101, 0.8611459640316926, 0.8747906197654145, 0.8751568381429421, 0.8789200415367795, 0.8777592669720041, 0.8833885666942008, 0.8932895546890308, 0.897892367505514, 0.8970811029187622, 0.9040899795499892, 0.9053363320383288, 0.9093490164265763, 0.909680689305529, 0.9145273331318884, 0.9222379317308761, 0.9257907542579166, 0.9277535717904741, 0.9319995958370896, 0.9323247604639076, 0.9339784295937561, 0.9336579427875584, 0.9352678571428268, 0.935483870967708, 0.9380097879282048, 0.9394930498773467, 0.9406736542179495, 0.9402985074626862, 0.9412006578947463, 0.9438063986874552, 0.9440229649374746, 0.9440229649374746, 0.9490283853901719, 0.9551152446421453, 0.9582488852857917, 0.9595949367088665, 0.9628880574375798, 0.9639284631706817, 0.9645131938125814, 0.9646750100928634, 0.9670307443365566, 0.9679052343828994, 0.9720760825576592, 0.9743745568722798, 0.976366771477865, 0.9761154588881454, 0.9763187315784593, 0.9774252593044862, 0.9774252593044862, 0.9787709497206885, 0.980841358337567, 0.9819399350649554, 0.9824133373996238, 0.9838431053754955, 0.9839332926581272, 0.9845465636437436, 0.9845465636437436, 0.985663446873404])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.30257029498024973, 0.5156495640991434, 0.6706467661693255, 0.7981007431876516, 0.8117733319368908, 0.8356095093576248, 0.7960124343445788, 0.7982300884957013, 0.8085758039817887, 0.807596849034259, 0.8703211290652715, 0.8803436285539701, 0.8803514866660288, 0.8872180451128217, 0.8844662175955165, 0.8875192604006427, 0.8887520525452044, 0.8892310851042544, 0.8908439897699327, 0.8952884908925353, 0.8947368421053817, 0.9017211528669742, 0.9031794871795309, 0.9065201912318895, 0.9102875658160123, 0.912743506493376, 0.9214659685863013, 0.9254328896005624, 0.9280589876445562, 0.9355286649474229, 0.9355286649474229, 0.9379337695815576, 0.9425789787402833, 0.9444444444444083, 0.947683109118063, 0.9486158135829329, 0.9521244763614448, 0.9540057866906115, 0.9528461768517772, 0.9555422647527946, 0.9578139024633697, 0.9593139210211541, 0.9616578236059854, 0.9620582640905228, 0.965226976650976, 0.9653306613226551, 0.9653306613226551, 0.9671917327180003, 0.9683957058292623, 0.9702870909456095, 0.9697821503865173, 0.9696665327440496, 0.9683977455716352, 0.9693856998992861, 0.9708757432227928, 0.9735567218409159, 0.9745608721986635, 0.9761760549162065, 0.9766831533259304, 0.9785815316225368, 0.979476291578193, 0.979476291578193, 0.9798399351636007, 0.9818403165263173])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3028630562264466, 0.5516483516483022, 0.6864999407371879, 0.7968376157287533, 0.8054037331134626, 0.8275652701882978, 0.8215784215784837, 0.7916622354567909, 0.8054708048395344, 0.8050473186119633, 0.8720918622066235, 0.8937115171090719, 0.9020686843982961, 0.9013096834072676, 0.9025524439393051, 0.9054624009876938, 0.9104890802831351, 0.9098738849585929, 0.9059197701858289, 0.9075061525841855, 0.905334566759299, 0.9113872060787408, 0.9102682701202813, 0.9169136433316573, 0.9198976982097251, 0.9238474905447889, 0.9220858895704593, 0.9253213629870494, 0.9257597389352673, 0.9257597389352673, 0.929188255613093, 0.9304497918570114, 0.9318112322901749, 0.9368324687213745, 0.9353596757851979, 0.9388459975619421, 0.931421068578928, 0.9284552845528408, 0.9288176840397373, 0.9312575818843349, 0.9335353535353651, 0.9395824969891531, 0.9421221864951803, 0.9438698664524492, 0.9466092357006751, 0.9491117133393577, 0.954884189325304, 0.9565831987075959, 0.9590619630041479, 0.9601613716590934, 0.9618258937588363, 0.9619307280622039, 0.9633148054573245, 0.971751412429401, 0.9731908889337194, 0.97448310640446, 0.9740849047091067, 0.9740849047091067, 0.9755900746419381, 0.9743019020639321, 0.9751163261177274, 0.9775303643724543, 0.9792447099321486, 0.982211441277537])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.5395374601853796, 0.6756756756754101, 0.7739265390583188, 0.7994403917255504, 0.818769894239492, 0.8375809061486821, 0.8317689530685369, 0.8323032550473272, 0.8409540672845708, 0.8556370776066756, 0.8652763295099761, 0.8752721617419448, 0.8846032910597225, 0.8853076601089407, 0.8862350722816917, 0.8920893341683167, 0.9012307374080593, 0.9049764489044984, 0.9098494098493992, 0.9112039963298949, 0.911713908361265, 0.9177971249241444, 0.9170323502398646, 0.9213736545361474, 0.929623235503205, 0.9311183144246576, 0.9318850878083749, 0.9353696773541036, 0.9356049082243085, 0.9374116696951627, 0.936101592420883, 0.9368037269596686, 0.9370190360469665, 0.9384537645275204, 0.9393449251920936, 0.9421169803683601, 0.9436605420769679, 0.9468374861293337, 0.9468374861293337, 0.9474215359774076, 0.9445560466050613, 0.9443443443443402, 0.9446612628839969, 0.9475681613901693, 0.9467989179440752, 0.9494179044560531, 0.9499799116110851, 0.9535796999295063, 0.9554460424419232, 0.9582831929402416, 0.9601605619669005, 0.9594458943987029, 0.9602967716061908, 0.9620582640904957, 0.9649929985997256, 0.9668464150189908, 0.9679935987197563, 0.9680063987202732, 0.9700670737811731, 0.9735651824304039, 0.9735651824304039, 0.9747713338023853, 0.9758405476142602])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3016914049014996, 0.5420016634318998, 0.6769890424008251, 0.8062191103787213, 0.7892656542540144, 0.8043546529884666, 0.8192893401014254, 0.8264965056212157, 0.8239919354836837, 0.7867106804385053, 0.8380855397146205, 0.8440897755608869, 0.8674340146853757, 0.8664646464647724, 0.8706567583853753, 0.8717168644152568, 0.8830111902339878, 0.8949517076572516, 0.9017306544660023, 0.9177283950618531, 0.9193245778612482, 0.9269853970795028, 0.9313145492831628, 0.9336971902163235, 0.931610014247939, 0.932483044842613, 0.9347517730496515, 0.9369752149721929, 0.9368218233445167, 0.9372970779221067, 0.9372401906113849, 0.9413314418887443, 0.940278766914236, 0.942239366561746, 0.9480780841215255, 0.948944723618068, 0.9533762057877763, 0.9516405855628286, 0.9555398729710618, 0.959072580645154, 0.9597579425113354, 0.9628436209847907, 0.962641357027465, 0.9644052327350191, 0.9656221478551839, 0.9658457484544373, 0.9662648161280364, 0.9668659438646144, 0.9670752709958379, 0.9670752709958379, 0.9688132847306843, 0.9688069677942293, 0.972699696663293, 0.9738515901059986, 0.9735300060618332, 0.9754123241930444, 0.9760485093481305, 0.9770637566939283, 0.9784739767559366, 0.9787578393688225, 0.9810671256454565, 0.9819838056680245, 0.9819838056680245, 0.9823886639676218])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.5346423562409466, 0.640288664924539, 0.7682162162160936, 0.7757203900514941, 0.8191663931735105, 0.835496914237101, 0.8598480907293543, 0.8603491271820253, 0.8652822706875546, 0.8757445060586615, 0.866081569437251, 0.879983808945659, 0.8848448084117524, 0.8934092758338298, 0.8945822784808535, 0.9057293783013614, 0.9134083930399564, 0.916181725370133, 0.9173806609547773, 0.9178655239262008, 0.9118789613576561, 0.9156405820699299, 0.9213187702266602, 0.9179926560587618, 0.9148309816262339, 0.9182197779814846, 0.9223409669211295, 0.9224506411561298, 0.9209425686014712, 0.9260763606824098, 0.9275362318840766, 0.9310483870968124, 0.9332661290322615, 0.9353796445880198, 0.9381965552178296, 0.9427671037917911, 0.9427671037917911, 0.9476445072127442, 0.9509487283003527, 0.9543852582821496, 0.9591795696762407, 0.9584799437016065, 0.9567409498840297, 0.9598227771623935, 0.9628735285240075, 0.9665120032277449, 0.9682683590208406, 0.9687091256665541, 0.9709460138735255, 0.9725213890287076, 0.9744209466263969, 0.974534474081529, 0.9764160451521712, 0.9770869082466777, 0.978753541076471, 0.978753541076471, 0.9792573105332246, 0.9796579293593641, 0.9796538111144718, 0.9819910967219607, 0.9829172141918495, 0.984842360549716, 0.9856478673943836])


#average_metadata_no_svd_more_data = list(np.mean(np.matrix(fscore_metadata_no_svd_more_data), axis=0).A1)


nadeef_fscore = 0.59098550956688811

openrefine_fscore = 0.7366


dboost_models = ["Gaussian", "Histogram", "Mixture"]
dboost_sizes = [50, 100, 150, 200]
dboost_fscore_all = [
                        # Gaussian
                        [
                            [0.538528896673, 0.538528896673, 0.387106163138, 0.536971350614, 0.538528896673],
                            [0.387106163138, 0.538528896673, 0.538528896673, 0.536971350614, 0.536971350614],
                            [0.536971350614, 0.536971350614, 0.538528896673, 0.538528896673, 0.538528896673],
                            [0.536971350614, 0.538528896673, 0.538528896673, 0.387106163138, 0.538528896673]
                        ],
                        # Histogram
                        [
                            [0.56778474014, 0.56778474014, 0.56778474014, 0.56778474014, 0.50033101622],
                            [0.50033101622, 0.56555613267, 0.56778474014, 0.56778474014, 0.56778474014],
                            [0.56555613267, 0.56555613267, 0.593559042114, 0.56778474014, 0.56555613267],
                            [0.56778474014, 0.56555613267, 0.593559042114, 0.56778474014, 0.56778474014]
                        ],
                        # Mixture
                        [
                            [0.682196339434, 0.682196339434, 0.501574365623, 0.501574365623, 0.682196339434],
                            [0.682196339434, 0.527322985329, 0.501574365623, 0.527322985329, 0.682196339434],
                            [0.682196339434, 0.682196339434, 0.682196339434, 0.682196339434, 0.682196339434],
                            [0.682196339434, 0.554024161987, 0.682196339434, 0.594272844273, 0.682196339434]
                        ]
                    ]

dboost_matrix_f = np.array(dboost_fscore_all)
dboost_avg_f = np.mean(dboost_matrix_f, axis = 2)


PlotterLatex(data, label_potential, fscore_metadata_no_svd_more_data,
         dboost_models, dboost_sizes, dboost_avg_f,
         nadeef_fscore,
         openrefine_fscore,
         None, xmax=200, filename="Flights")