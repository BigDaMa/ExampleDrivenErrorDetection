import numpy as np

from ml.datasets.flights.FlightHoloClean import FlightHoloClean
from ml.plot.old.user_effort_all_potential.PlotterLatex import PlotterLatex

data = FlightHoloClean()

label_potential = [4, 8, 12, 16, 26, 36, 46, 56, 66, 76, 86, 96, 106, 116, 126, 136, 146, 156, 166, 176, 186, 196, 206, 216, 226, 236, 246, 256, 266, 276, 286, 296, 306, 316, 326, 336, 346, 356, 366, 376, 386, 396, 406, 416, 426, 436, 446, 456, 466, 476, 486, 496, 506, 516, 526, 536, 546, 556, 566, 576, 586, 596, 606, 616, 626, 636, 646, 656]


fscore_metadata_no_svd_more_data = []
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.06907378335952005, 0.3248163526028094, 0.3557976653694157, 0.5593635250916714, 0.6311401532221945, 0.6413334887514964, 0.6678445229680989, 0.6759169884168438, 0.6981402002860709, 0.7555555555554058, 0.8343313373252078, 0.8716697173072517, 0.8925720060636271, 0.8962849872773265, 0.8971067644661764, 0.8983646031905436, 0.8982463093233019, 0.8973906219345965, 0.9044009057793936, 0.9010710808180331, 0.8997751051138287, 0.9054294175714485, 0.9044560814147491, 0.91044924793297, 0.9135285913527537, 0.9135285913527537, 0.9179574297992201, 0.9191404297851713, 0.9209237228831976, 0.92589992981056, 0.9269758589602812, 0.9303167420814906, 0.9308532147189988, 0.9315235008103144, 0.9337929636013238, 0.9343613675560377, 0.9351833097022517, 0.9369040373300508, 0.9400363416111505, 0.9432937864467871, 0.9486768243784819, 0.9504016064256892, 0.9547497752472112, 0.9559572555677625, 0.9607862802126138, 0.9638263665594701, 0.9641386238071217, 0.9659672723622038, 0.9685142339804915, 0.9683512508791216, 0.968989126057174, 0.9691904953684811, 0.973136740052518, 0.9741414141413985, 0.9735193046290445, 0.9744887629074659, 0.9756740320291843, 0.9760600527490259, 0.9752133279154677, 0.9747233783372129, 0.9748274462038072, 0.9758522727272657, 0.9759561732778668, 0.9769986827439191])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3057851239666757, 0.5193497338511738, 0.528452959679706, 0.5915456764743994, 0.5845516884459789, 0.6280535855002436, 0.626404123166382, 0.7712495566852162, 0.7712495566852162, 0.7962747380674516, 0.8341876532204179, 0.8716020199849763, 0.8862900699593184, 0.8931106471815374, 0.8899760591234204, 0.8966820663585774, 0.9004808697471092, 0.9027792343996313, 0.9028403731265733, 0.9028403731265733, 0.9040923399791129, 0.902249316796402, 0.9059901042214118, 0.9063914920500435, 0.9069669543252926, 0.9086738949123193, 0.9086757990867854, 0.9173613255120178, 0.9154460046469679, 0.9231866340668712, 0.9251200326897737, 0.9237969274595981, 0.9239064089522302, 0.9241112356117975, 0.9248319413323692, 0.924311693589449, 0.924311693589449, 0.9242947026589011, 0.9221361598042471, 0.922214292996149, 0.9223688247928112, 0.9241112356116477, 0.924707080998434, 0.9282004277422048, 0.9288983826671602, 0.9334279055629202, 0.9378154653745402, 0.942572664185882, 0.9466599698644103, 0.9506592089492808, 0.949311514667758, 0.9523714428357752, 0.9565391147967013, 0.9568870661198642, 0.9570269458078974, 0.9586047910193795, 0.9608255685803161, 0.9618198216254232, 0.9618045112782238, 0.9629778268285425, 0.9647200723690996, 0.9658782083543398, 0.9670794321957173, 0.9670794321957173])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.033180091944860615, 0.4301982285956287, 0.43296949342300783, 0.5926880712447035, 0.6042493579267632, 0.64213052920341, 0.6415495452933704, 0.758151587130153, 0.821374045801558, 0.8619288333828975, 0.8709191361125648, 0.87482806052274, 0.8951224214381753, 0.8931305106094253, 0.8969484254655429, 0.9090729001586166, 0.9118146409667439, 0.9144465668040753, 0.9142278481012697, 0.9142740785990504, 0.9153783563872663, 0.9189575881451798, 0.9181949309705666, 0.9166924106682616, 0.9218910585817096, 0.9128849270664086, 0.9226536227453443, 0.9294807031723676, 0.9355821987401125, 0.9359104781281822, 0.9408547701033003, 0.9426287564504631, 0.9420038732035392, 0.9405272838748955, 0.9357590708191506, 0.9344870210135535, 0.9368052696582585, 0.9413092550789933, 0.9416350394912257, 0.9438822447102156, 0.9477459016393384, 0.9477459016393384, 0.9487914789020906, 0.9496932515337305, 0.9559335929493568, 0.9603020716399511, 0.9566544566544515, 0.9592521085255425, 0.9535899258657544, 0.9557522123893853, 0.957909719398131, 0.9564951604686642, 0.958825927435785, 0.9623830825538737, 0.9660775949624061, 0.9687753446877443, 0.9730656713406529, 0.9739499192245503, 0.9745557350565429, 0.9749798224374452, 0.9789856536674122, 0.9795835860117179, 0.9804675640117362, 0.9805707346690941])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.08299240210404761, 0.46905973747638713, 0.5815171070254481, 0.6794005909666979, 0.6255006675567241, 0.7201906143168711, 0.7186340014848639, 0.726774805140155, 0.7511403953371952, 0.7668088563885173, 0.7771947527752497, 0.7832037325041049, 0.8727098321343918, 0.8809682645574333, 0.8989607390300993, 0.9040045985821931, 0.9073537927040563, 0.9102763721293315, 0.9093983092988398, 0.9114402146903998, 0.9075979422239604, 0.907922065077585, 0.907368630970144, 0.9176609801793806, 0.9211331556607585, 0.9224376731300847, 0.9277084571201463, 0.9287692916501188, 0.9338061465720634, 0.9383867447167235, 0.9399861124887766, 0.940196370127881, 0.9465144230769786, 0.950086058519825, 0.9456236102689785, 0.9455390522381327, 0.9517574780944914, 0.9517574780944914, 0.9548621629809398, 0.9565217391304516, 0.9544122106540064, 0.9534672453820348, 0.9566881547139419, 0.9600080588294597, 0.9609186140209487, 0.9623135832325642, 0.9627316680096749, 0.9627316680096749, 0.9640056304042073, 0.9633666363911683, 0.9638505689256056, 0.96446189469448, 0.9672873678913149, 0.9699164905926196, 0.9704225352112454, 0.9681964573268661, 0.9687028278152441, 0.9703927492447334, 0.9719983883964801, 0.9717571111559694, 0.9745660072668644, 0.9754371778025246, 0.9783751010509691, 0.9805628669771501])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.15580110497213334, 0.45950776845875535, 0.5235830870066935, 0.6042289128935577, 0.6188856304983782, 0.6380941525130275, 0.7123797025368406, 0.7364391951005121, 0.8015798773514802, 0.822887722548089, 0.8540918163672532, 0.8633192492875631, 0.8647959183673553, 0.8746708280503666, 0.878204508077819, 0.8944540395318076, 0.8927886459531531, 0.8946863610204586, 0.8906749297955985, 0.8986921725551912, 0.9038593734655205, 0.9124789374565491, 0.9179282868526878, 0.9254720771393533, 0.924665856622017, 0.9253821399838367, 0.9322974472807998, 0.9392499747296171, 0.9400202634245146, 0.9426312588688789, 0.9298299845440978, 0.9513327948304123, 0.9542139384116921, 0.9553843033867394, 0.9580002024086839, 0.9591816064012975, 0.9597479162431187, 0.960373907742302, 0.9605931342677188, 0.9613315741398502, 0.9615306330144492, 0.9631519853016063, 0.967787826440374, 0.9679578178868448, 0.9692479447883996, 0.9713359667780967, 0.9705583756345416, 0.9715678310316855, 0.9729894394800868, 0.9748907187150666, 0.975287297874515, 0.9744110479285238, 0.9695682944090878, 0.9729509863738195, 0.9785808547355844, 0.9777192627101697, 0.9795090282004686, 0.9795048701298923, 0.9798072044647618, 0.9778999898156495, 0.9815228426395951, 0.9817295980511601, 0.9818329442809337, 0.9831643002028547])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.29947430897061234, 0.5727470837072589, 0.6947073256221855, 0.8057333970378746, 0.8250464003125706, 0.8417859512749695, 0.8506432966622572, 0.8575192923018526, 0.8461538461538757, 0.8502295332823497, 0.8578978273635004, 0.8560173330707651, 0.8578730096324737, 0.8590868750617128, 0.8728689722358529, 0.8767015190372839, 0.8910812943962158, 0.8971136854506009, 0.8986740550167205, 0.899732752647644, 0.902400317397256, 0.9040824415377486, 0.9045166402534396, 0.9098116947473035, 0.9130954753837057, 0.916566143948495, 0.9192071636985424, 0.9217146307103479, 0.924357945425316, 0.9249170770931548, 0.9295176458690896, 0.9324583543664678, 0.9331989924432873, 0.9338976219267445, 0.9367497225866113, 0.9369387549188858, 0.936448786383421, 0.9377141705302466, 0.9377710539587489, 0.9391885055146193, 0.9407602102708683, 0.9456269545042614, 0.9484079000403802, 0.9529269764634883, 0.9552148476901273, 0.9584509883017261, 0.9616388833098923, 0.962784148058726, 0.9649828939424409, 0.9678394999495796, 0.968503937007873, 0.9702410975486606, 0.970027247956397, 0.9737638748738658, 0.9716828478964349, 0.9749924066011973, 0.9760145734237309, 0.9781925144537968, 0.9803921568627237, 0.9810325590830579, 0.9824418958692799, 0.9828548239829615, 0.982481012658209, 0.9843813387423844])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.10878339419583119, 0.43255328662976367, 0.60103764799761, 0.7327119011487032, 0.7446764091855914, 0.7533398501139285, 0.8290144868393549, 0.8406452275760912, 0.8627212948911895, 0.8609045226130998, 0.8598726114651263, 0.8536633663368014, 0.857782299084604, 0.8762742354588944, 0.8753352537996926, 0.887805848418696, 0.8961051897598549, 0.9032387045180951, 0.9102000000000193, 0.9102000000000193, 0.9133606475467437, 0.9148418491483618, 0.9149863208025428, 0.911292764153834, 0.9119757453259866, 0.9128764908025497, 0.914723988293517, 0.9157383026128703, 0.9168352893564564, 0.9169448659584474, 0.9168689320387653, 0.9181487469684113, 0.9228896103895192, 0.9278894982733434, 0.9292313940500946, 0.933807106598896, 0.935062283030343, 0.9362224039246944, 0.9388172703088885, 0.9381127450979343, 0.9400450173929807, 0.9446081918894048, 0.9488992122803076, 0.9527551123198961, 0.9565042287555147, 0.9553472432214251, 0.9600481830957263, 0.9633655394524581, 0.9653161757313523, 0.9665995975855002, 0.9673005332528288, 0.9700442299959465, 0.9712041884816758, 0.971953188054886, 0.9717457114026351, 0.9734764122292193, 0.9745513535435721, 0.9751062537947796, 0.9762217950015324, 0.9769510715730023, 0.9785988289925408, 0.9814403873310348, 0.9826612903225875, 0.9830576845502285])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.030018010806515595, 0.42987761991835305, 0.5749675592780034, 0.6791258169934066, 0.6969759734879099, 0.699866241382788, 0.7299300553292998, 0.7573612393556537, 0.7815366406942539, 0.8050490883589331, 0.8148662041625134, 0.8743873137914363, 0.8837618535535341, 0.8808493904835802, 0.8910100321417503, 0.8906417372674289, 0.8935723822238548, 0.8933510134494611, 0.8922354781928145, 0.9042182662538649, 0.9114366087885187, 0.9201933510899792, 0.9159571271161355, 0.917508249175065, 0.9190109120031508, 0.9254652204199013, 0.9299579747848374, 0.9336955428110958, 0.9366884750880826, 0.9413779210314385, 0.9426312588688286, 0.9458563535911435, 0.9481407035175885, 0.9482775936527249, 0.9501807955002363, 0.9540287697414872, 0.9570897397246604, 0.9581283261371589, 0.9598957288951284, 0.9609218436873763, 0.9628884642462094, 0.9632093538957802, 0.9640417838489433, 0.966864739651539, 0.9672859450726893, 0.968497576736697, 0.9686143909577305, 0.96891400888173, 0.9687184661957687, 0.9691904953685067, 0.9702890522711495, 0.9706000805477528, 0.9722557297949599, 0.9747510310833992, 0.9747662611842529, 0.9771928061890659, 0.9768378650553876, 0.9794230381278927, 0.9771855441146858, 0.979286652520975, 0.9790464621925247, 0.9828213419563238, 0.9836131903701988, 0.9847274198442332])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.3013982392540751, 0.49791935715312174, 0.6249568717655063, 0.6567328918323864, 0.6805149843125631, 0.728962418300722, 0.7627391742196563, 0.8193217751608375, 0.8203508007408254, 0.8310675519019634, 0.8596618608026034, 0.8707427164544844, 0.8885489956152309, 0.8970498474059063, 0.9030408518480704, 0.9079678814081982, 0.9177356953776936, 0.9160782731490648, 0.9225773718923987, 0.9234823147866378, 0.9237786336914463, 0.9231077694235197, 0.9266201395812952, 0.9246091026790646, 0.9211609922666898, 0.9255851170233522, 0.9288299155609309, 0.929181315921665, 0.9328380684670229, 0.9330254041570453, 0.9365765403558016, 0.9397929440144585, 0.9442891373801985, 0.947441906851537, 0.9506789137380193, 0.9507836677648016, 0.9524000400841823, 0.9539907981596558, 0.9573060733614016, 0.9619565217391208, 0.9643796802266794, 0.9655731065208708, 0.9659781287970833, 0.966808338393035, 0.9683276175105889, 0.9704106280193284, 0.9710144927536334, 0.9729675206778352, 0.9750151118275359, 0.9762144728885354, 0.9787533984493021, 0.9787533984493021, 0.9800242130750683, 0.9814403873310642, 0.9806973218797274, 0.9815244825845483, 0.9822042467138433, 0.9830988766319159, 0.9838056680161913, 0.9838922095025823, 0.9838922095025823, 0.9832775919732468, 0.9839951377633709, 0.9839951377633709])
fscore_metadata_no_svd_more_data.append([0.0, 0.0, 0.0, 0.0, 0.2776124628039549, 0.40235585864827994, 0.5960689931807592, 0.7110389610388661, 0.7188200589970525, 0.778867924528417, 0.7853881278539908, 0.7965097490037243, 0.8192719940571352, 0.8467857876361123, 0.8588437090102076, 0.8792569659443544, 0.8884210526315041, 0.8947689802564708, 0.9037454691904794, 0.9000805801771973, 0.9112078566366673, 0.9208050976029504, 0.91277353689573, 0.9257003654080637, 0.9303694681283033, 0.9344009855250951, 0.9344009855250951, 0.9309241094476304, 0.9329476185556603, 0.9351985188232992, 0.9369981470043334, 0.9389219102274831, 0.9439773072636855, 0.9501519756839164, 0.9510220603117062, 0.9532009724473482, 0.9550334211059505, 0.9572874493927307, 0.9596667682617119, 0.9607226225514995, 0.9620278937188261, 0.9641800183692086, 0.9683055668427525, 0.9686198842287089, 0.9702386998476212, 0.9709053916581586, 0.9717951328785, 0.9747659747659794, 0.9758326563769198, 0.9763667714778289, 0.9772773382024724, 0.9774847870182554, 0.9774847870182554, 0.9771689497716901, 0.9787190920146069, 0.9793396799676057, 0.9826975614692108, 0.9823708206686971, 0.9830645979109632, 0.983679675620891, 0.9840948232195328, 0.9855131192381662, 0.9855131192381662, 0.9855131192381662, 0.9866369710467677, 0.9868421052631564, 0.986931415256813, 0.9868207623682203])


#average_metadata_no_svd_more_data = list(np.mean(np.matrix(fscore_metadata_no_svd_more_data), axis=0).A1)


nadeef_fscore = 0.59098550956688811

openrefine_fscore = 0.7366


dboost_models = ["Gaussian", "Histogram", "Mixture"]
dboost_sizes = [50, 100, 150, 200]
dboost_fscore_all = [
                        # Gaussian
                        [
                            [0.538528896673, 0.538528896673, 0.387106163138, 0.536971350614, 0.538528896673],
                            [0.387106163138, 0.538528896673, 0.538528896673, 0.536971350614, 0.536971350614],
                            [0.536971350614, 0.536971350614, 0.538528896673, 0.538528896673, 0.538528896673],
                            [0.536971350614, 0.538528896673, 0.538528896673, 0.387106163138, 0.538528896673]
                        ],
                        # Histogram
                        [
                            [0.56778474014, 0.56778474014, 0.56778474014, 0.56778474014, 0.50033101622],
                            [0.50033101622, 0.56555613267, 0.56778474014, 0.56778474014, 0.56778474014],
                            [0.56555613267, 0.56555613267, 0.593559042114, 0.56778474014, 0.56555613267],
                            [0.56778474014, 0.56555613267, 0.593559042114, 0.56778474014, 0.56778474014]
                        ],
                        # Mixture
                        [
                            [0.682196339434, 0.682196339434, 0.501574365623, 0.501574365623, 0.682196339434],
                            [0.682196339434, 0.527322985329, 0.501574365623, 0.527322985329, 0.682196339434],
                            [0.682196339434, 0.682196339434, 0.682196339434, 0.682196339434, 0.682196339434],
                            [0.682196339434, 0.554024161987, 0.682196339434, 0.594272844273, 0.682196339434]
                        ]
                    ]

dboost_matrix_f = np.array(dboost_fscore_all)
dboost_avg_f = np.mean(dboost_matrix_f, axis = 2)


PlotterLatex(data, label_potential, fscore_metadata_no_svd_more_data,
         dboost_models, dboost_sizes, dboost_avg_f,
         nadeef_fscore,
         openrefine_fscore,
         None, xmax=200, filename="Flights")